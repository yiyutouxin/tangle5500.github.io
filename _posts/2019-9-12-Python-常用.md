---
layout:     post
title:      Python 常用
subtitle:   
date:       2019-9-12
author:     Tangle
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Python
---

| 语法                                                 | 作用                                         |
| :--------------------------------------------------- | :------------------------------------------- |
| \n                                                   | 换行                                         |
| \t                                                   | Tap 键                                       |
| chr(数字)                                            | 数字转换成 ASCII 码                          |
| id(变量)                                             | 查看变量的内存地址                           |
| repr('字符')                                         | 输出原生字符，比如 \n                        |
| eval('')                                             | 计算字符串中的数学运算。字符串转换其他类型。 |
| os.exit(0)                                           | 强制关闭脚本                                 |
| os.startfile(r'‪‪c:\\')                                | 打开文件                                     |
| os.getcwd()                                          | 获取当前路径                                 |
| os.remove(路径)                                      | 删除文件                                     |
| os.path.join('C:\\\\','Users','Easy Love','Desktop') | 路径拼接                                     |
| map(int,list)                                        | 把 list 中数字转换成 int                     |
| print(dir(函数))                                       | 帮助信息                     |
| print(help(str.upper))                                       | 帮助信息                     |
| test = 0x53                                  | 赋值一个 16 进制数                     |

# 回车和换行的区别

在 windows 中

```
'\r' 回车，回到当前行的行首，而不会换到下一行，如果接着输出的话，本行以前的内容会被逐一覆盖
'\n' 换行，换到当前位置的下一行，而不会回到行首
```

# excel

## 实时修改

```python
# -*- coding=gbk -*-

import os
import xlwt,xlrd
import win32com.client

class App():

    file = 'test.xls'
    file_path = os.path.join(os.getcwd(),file)
    
    def __init__(self):
        '''create excel'''
        if self.file not in os.listdir('.'):
            xlwt_book = xlwt.Workbook()
            xlwt_sheet = xlwt_book.add_sheet('sheet1')
            xlwt_book.save(self.file)

        '''read excel'''
        self.xlrd_book = xlrd.open_workbook(self.file)
        self.xlrd_sheet = self.xlrd_book.sheets()[0]
        self.cols = self.xlrd_sheet.col_values(0) # 获取第一列数据

        '''write excel'''
        self.excel = win32com.client.Dispatch('Excel.Application')
        self.excel.Visible = -1
        self.win32_book = self.excel.Workbooks.Open(self.file_path)
        self.win32_sheet = self.win32_book.Worksheets('sheet1')
        self.win32_book.save
    
if __name__ == '__main__':
    App()
```
## 清空拷贝

```
# -*- coding=gbk -*-
import os
import xlwt,xlrd

class App():

    file = '二甲醚.xls'

    def __init__(self):
        xlrd_book = xlrd.open_workbook(self.file,formatting_info=True)
        xlrd_sheet = xlrd_book.sheets()[0]
        # row = xlrd_sheet.nrows # 获取有效行数
        xlwt_book = xlwt.Workbook()
        xlwt_sheet = xlwt_book.add_sheet('sheet1')
        cols = xlrd_sheet.col_values(0) # 获取第一列数据
        xlwt_sheet.write(1,0,'demo') # 写入数据
        xlwt_book.save('new'+self.file)
    
if __name__ == '__main__':
    App()
```

## 修改拷贝

```
# -*- coding=gbk -*-
import os
import xlwt,xlrd
from xlutils.copy import copy

class App():

    file = '二甲醚.xls'

    def __init__(self):
        xlrd_book = xlrd.open_workbook(self.file,formatting_info=True)
        xlrd_sheet = xlrd_book.sheets()[0]
        # row = xlrd_sheet.nrows # 获取有效行数
        xlwt_book = copy(xlrd_book)
        xlwt_sheet = xlwt_book.get_sheet(0)
        cols = xlrd_sheet.col_values(0) # 获取第一列数据
        xlwt_sheet.write(1,0,'demo') # 写入数据
        xlwt_book.save('new'+self.file)
    
if __name__ == '__main__':
    App()
```

# 注意

解决尚未调用 CoInitialize，问题出现在多线程连接数据库

```python
import pythoncom
def demo():
	pythoncom.CoInitialize()

t2 = threading.Thread(target=demo)
t2.start()
```
