---
layout:     post
title:      B站 视频投稿
date:       2020-10-16
author:     Tangle
catalog: true
tags:
    - B站
---

# 获取登录Cookies

0. <https://gitee.com/nbodyfun/bilibili_video_uploader>
0. <https://gitee.com/tangle5500/bilibili_video_uploader>
0.  查看网站信息 — Cookie — bilibili.com — Cookie
    ```
    SESSDATA
    bili_jct
    ```

# 例子

```
-sd [SESSDATA] # SESSDATA
-bj [bili_jct] # bili_jct
-s [SOURCE]    # 来源声明
-t [TITLE]     # 标题
[video_path]   # 视频文件
```

```
python bilibili_up.py -sd [SESSDATA] -bj [bili_jct] -t [TITLE] -s [SOURCE] [video_path]
```

# 成品

```
import subprocess,os

bilibili_up_path = r"C:\Users\CCG\Desktop\bilibili_video_uploader"      # bilibili_up_path 路径
path = r"C:\Users\CCG\Desktop\123"                                      # vedio 路径

def bilibili():
    _sd = ''                                                            # SESSDATA
    _bj = ''                                                            # bili_jct
    _title = os.listdir(path)[0].split('.mp4',1)[0].split('_____',1)[1] # 标题
    _id = os.listdir(path)[0].split('.mp4',1)[0].split('_____',1)[0]    # id
    _s = "https://m.weibo.cn/detail/" + _id                             # 来源声明和视频描述
    _video_path = os.listdir(path)[0]                                   # 视频文件
    _cd = f"cd /d {path}"                                               # 切换工作路径
    _bilibili_up = bilibili_up_path + r"bilibili_up.py"                 # bilibili_up_path 文件

    _cmd = f'{_cd} & python "{_bilibili_up} -sd "{_sd}" -bj "{_bj}" -t "{_title}" -s "{_s}" "{_video_path}"'
    subprocess.call(_cmd, shell=True, stdin=subprocess.PIPE, stdout=subprocess.PIPE, stderr=subprocess.PIPE)

bilibili()
```

# ERROR

0. 
    ```
    Traceback (most recent call last):
      File "D:\Python\bilibili\bilibili_video_uploader\bilibili_up.py", line 397, in <module>
        script_main()
      File "D:\Python\bilibili\bilibili_video_uploader\bilibili_up.py", line 393, in script_main
        ).publish_video(args.video_path, atitle=args.title, adesc=args.desc, acopyright=args.copyright, asource=args.source, specified_type=args.typeid, specified_tags=args.tags)
      File "D:\Python\bilibili\bilibili_video_uploader\bilibili_up.py", line 84, in publish_video
        res1 = self.preupload(filename=filename, filesize=filesize)
      File "D:\Python\bilibili\bilibili_video_uploader\bilibili_up.py", line 274, in preupload
        headers={'TE': 'Trailers'}
      File "D:\Tangle\Python 3.6.5\lib\site-packages\requests\models.py", line 898, in json
        return complexjson.loads(self.text, **kwargs)
      File "D:\Tangle\Python 3.6.5\lib\json\__init__.py", line 354, in loads
        return _default_decoder.decode(s)
      File "D:\Tangle\Python 3.6.5\lib\json\decoder.py", line 339, in decode
        obj, end = self.raw_decode(s, idx=_w(s, 0).end())
      File "D:\Tangle\Python 3.6.5\lib\json\decoder.py", line 357, in raw_decode
        raise JSONDecodeError("Expecting value", s, err.value) from None
    json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    ```
0. 重新设置 `SESSDATA` 和 `bili_jct`
