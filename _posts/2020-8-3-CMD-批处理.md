---
layout:     post
title:      CMD 批处理
subtitle:   
date:       2020-7-2
author:     Tangle
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - CMD
---

# 禁用网卡

| 命令                                                         | 作用     |
| ------------------------------------------------------------ | -------- |
| netsh interface set interface name="无线网络连接" admin=DISABLED | 禁用网卡 |
| netsh interface set interface name="无线网络连接" admin=ENABLED | 开启网卡 |

```
if "%1"=="h" goto begin 
start mshta vbscript:createobject("wscript.shell").run("""%~nx0"" h",0)(window.close)&&exit 
:begin
%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exit
netsh interface set interface name="无线网络连接" admin=DISABLED
```

# dll 注册

32位系统

```
%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exit
copy dm.dll %windir%\system32\
regsvr32 %windir%\system32\dm.dll
```

64位系统

```
copy dm.dll %windir%\SysWOW64\
%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exit
regsvr32 %windir%\SysWOW64\dm.dll
```

32位系统解除服务器注册

```
%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exit
regsvr32 /u %windir%\system32\dm.dll
```

64位系统解除服务器注册

```
%1 mshta vbscript:CreateObject("Shell.Application").ShellExecute("cmd.exe","/c %~s0 ::","","runas",1)(window.close)&&exit
regsvr32 /u %windir%\SysWOW64\dm.dll
```

# 清空回收站

```
for %%i in (A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) do rd /s /q %%i:\$Recycle.Bin
```

xp 系统

```
for %%i in (A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z) do rd /s /q %%i:\$Recycle
```

# 修改 ip地址与 dns

ip 地址

| 命令                                                         | 作用                                             |
| ------------------------------------------------------------ | ------------------------------------------------ |
| netsh int ip set address "本地连接" stat 192.168.1.1 255.255.255.0 192.168.1.1 1 | 修改 ip地址，子网掩码 ，网关。也可以不修改网关。 |
| netsh int ip set address "本地连接" dhcp                     | 自动获取 ip地址                                  |

dns

| 命令                                            | 作用           |
| ----------------------------------------------- | -------------- |
| netsh int ip set dns "本地连接" stat 8.8.8.8    | 清空并设置 dns |
| netsh int ip add dns "本地连接" 114.114.114.114 | 添加 dns       |
| netsh int ip set dns "本地连接" dhcp            | 自动获取 dns   |
| ipconfig /flushdns                              | 清空 dns缓存   |

| dns             | 作用       |
| --------------- | ---------- |
| 8.8.8.8         | 谷歌服务器 |
| 114.114.114.144 | 广告拦截   |
| 114.114.114.119 | 病毒拦截   |
| 114.114.114.110 | 色情拦截   |

# U盘屏蔽与恢复

| 属性 | 作用                 |
| ---- | -------------------- |
| /v   | 指定子项下的名称     |
| /t   | 指定项值的数据类型   |
| /d   | 指定新注册表的值     |
| /f   | 不用询问信息直接添加 |

U盘屏蔽

```
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR" /v Start /t reg_dword /d 4 /f
```

U盘恢复

```
reg add "HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\USBSTOR" /v Start /t reg_dword /d 3 /f
```

# 锁屏

```
rundll32.exe user32.dll,LockWorkStation
```
