---
layout:     post
title:      Python 大漠插件
subtitle:   
date:       2019-9-12
author:     Tangle
header-img: img/post-bg-ios9-web.jpg
catalog: true
tags:
    - Python
---

```
版本
python 3.4.3
大漠 3.1233

文件
dm.dll
regDll.dll

注册大漠使用管理员身份
regsvr32 dm.dll
```

默认前台，绑定句柄为后台操作。

| 语法                                                         | 返回值 | 作用             | 注意       |
| ------------------------------------------------------------ | ------ | ---------------- | ---------- |
| dm = win32com.client.Dispatch('dm.dmsoft')                   |        | 调用大漠插件     |            |
| print(dm.ver)                                                | 版本号 | 版本号           |            |
| dm.BindWindow(句柄,'dx2','windows','windows',0)              |        | 绑定句柄         |            |
| dm.SetDict(0, "C:\字库.txt")                                 |        | 设置大漠字库     |            |
| dm.GetMousePointWindow()                                     | 句柄   | 获取鼠标指向句柄 |            |
| dm.Ocr(17,262 ,58,280 ,"ffffff-000000",0.9)                  |        | 识别区域文字     |            |
| dm.FindStr(0, 0, 2000, 2000, "回收", "ffffff-000000", 1.0, X, Y) |        | 区域找字         |            |
| dm.FindPic(0,0,2000,2000,r'c:\666.bmp','000000',0.8,0,0,0)   | 坐标   | 区域找图         |            |
| dm.MoveTo(x,y)                                               |        | 鼠标移动位置     |            |
| dm.LeftDown()                                                |        | 鼠标左键按下     |            |
| dm.LeftUp()                                                  |        | 鼠标左键弹起     |            |
| dm.LeftClick()                                               |        | 左键单击         |            |
| dm.LeftDoubleClick()                                         |        | 左键双击         |            |
| dm.KeyPressChar('65')                                        |        | 模拟按键         | 必须为后台 |
| dm.WheelDown()                                               |        | 滚轮向下滚动     |            |
| dm.WheelUp                                                   |        | 滚轮向上滚动     |            |

# 后台找图

```
import win32com.client
import win32api
import win32con

dm = win32com.client.Dispatch('dm.dmsoft')

hwnd = win32gui.FindWindow('SciCalc', '计算器')
hwnd = win32gui.FindWindowEx(hwnd,None,'Window',None)

dm.BindWindow(hwnd,'dx2','windows','windows',0)
xy = dm.FindPic(0,0,2000,2000,r"C:\666.bmp","000000",0.9,0,x,y)
dm.MoveTo(xy[1],xy[2])
dm.LeftDown()
dm.LeftUp()
```
