---
layout:     post
title:      Python 爬虫
subtitle:   
date:       2019-9-21
author:     Tangle
header-img: img/post-bg-ios9-web.jpg
catalog: true
mathjax: false
tags:
    - Python
---

# requests

```shell
pip install requests
```

```python
# coding=gbk
import requests

response = requests.get('https://pixivic.com/popSearch')
print(response.status_code) # 打印状态码
print(response.url)         # 打印请求url
print(response.headers)     # 打印头信息
print(response.cookies)     # 打印cookie信息
print(response.text)        # 以文本形式打印网页源码
print(response.content)     # 以字节流形式打印网页源码
```

# xpath

```shell
pip install xlml
```

```python
from lxml import etree
import requests

_requests = requests.get('https://pixivic.com/popSearch')
html_data = etree.HTML(_requests.content)           # 获取 html 源码
ima = html_data.xpath('/html/body/div[5]/img/@src') # 匹配数据
```

# 下载图片

```python
from multiprocessing import Pool
import requests

def _requests(html):
    requests_obj = requests.get(html)
    return requests_obj

def _down(image):
    with open(image[-15:], 'wb+') as f:
        im = _requests(image)
        f.write(im.content)

if __name__ == '__main__':
    images = []
    img = 'http://img.netbian.com/file/2019/0423/f18e61ee804bfee503bc42913883a1a3.jpg'
    images.append(img)
    pool = Pool(1) # 多线程
    pool.map(_down, images)
    pool.close()
    pool.join()
```







<div class="mermaid">
    graph LR
        main(Vim 常用命令速查)---编辑(编辑)
        编辑--字符---字符编辑("
            s 删除当前字符插入<br>
            nx 向后删除n个字符
        ")
        编辑--单词编辑---单词编辑("
            daw 删除光标所在单词包括空白<br>
            diw 删除光标所在单词不包括空白<br>
            dw 从当前位置删除到下一个单词词首
        ")
        编辑---行编辑(行)
        行编辑---行编辑1("
            D 删除光标到行尾<br>
            C 删除光标到行尾插入<br>
            S 修改一整行<br>
            A 行尾插入<br>
            I 行首插入<br>
            5yy 复制从当前行开始的5行<br>
            dnG 删除第n行到当前行<br>
            dG 删除当前行到最后一行的数据
        ")
        编辑---重复(撤销及重复)
        重复---撤销1("
            . 重复上一个命令<br>
            ctrl-r 重做<br>
            :e! 文档还原到最初始状态
        ")
        编辑---编辑1(编辑)
        编辑1---编辑2("
            p 粘贴到光标前<br>
            P 粘贴到光标后<br>
            d 剪切
        ")
        main---find(搜索)
        find---find1("
            /str 从光标位置向下搜索 str<br>
            ?str 从光标位置向上搜索 str<br>
            n 找下一个<br>
            N 找上一个
        ")
        main---块(块操作)
        块---块1("
            v 字符选择<br>
            V 行选择<br>
            ctrl-r 块选择<br>
            y 复制被选中的数据<br>
            d 删除被选中的数据
        ")
        main---多(多文件编辑)
        多---多1("
            vim file1 file2 同时编辑两个文件<br>
            :files | :ls 列出 vim 当前打开个文件列表<br>
            :n 编辑下一个文件<br>
            :N 编辑上一个文件
        ")
        main---多窗口(多窗口操作)
        多窗口---多窗口1("
            :sp file2 竖向打开一个窗口<br>
            :vs file2 横向打开一个窗口<br>
            :ctrl-wj 窗口向下切换<br>
            :ctrl-wk 窗口向上切换<br>
            :ctrl-ww 窗口循环切换 
        ")
        main---插(插入)
        插---插1("
            I 在行首插入<br>
            A 在行尾插入<br>
            - 大小写转化
        ")
        main---光(光标移动)
        光---字符(字符)
        字符---字符1("
            n space 向后移动n字符
        ")
        光---单(单词)
        单---单1("
            w 下一个单词词首<br> 
            W 下一个空字符前<br>
            e 下一个单词词尾<br>
            b 前一个单词词首<br>
            ge 前一个单词最后一个字符
        ")
        光---行(行)
        光--d---行1("
            0 | ^ | Home 到行首<br>
            $ | end 到行尾<br>
            nG 到第n行<br>
            :n enter 光标到文档第n行<br>
            n enter 向下移动n行
        ")
        光---句(句)
        句---句1("
            ( 到句首<br>
            ) 到句尾
        ")
        光---段(段)
        段---段1("
            { 到段首<br>
            } 到段尾
        ")
        光---屏幕(屏幕)
        屏幕---屏幕1("
            ctrl-u 向上滚动半屏<br>
            ctrl-d 向下滚动半屏<br>
            pageup | ctrl-b 向上滚动整屏<br>
            pagedown | ctrl-f 向下滚动整屏  
        ")
        光---跳转(跳转)
        跳转---跳转1("
            ctrl-o 调回原来的位置
        ")
        main---折行(折行)
        折行---折行1("
            zi 开关所有折行<br>
            space 开关折行
        ")
        main---文本替换(文本替换)
        文本替换---文本替换1("
            :s/1/2/ 当前行 1 替换成 2<br>
            :s/1/2/g 当前行所有匹配<br>
            :%s/1/2/g 文件中所有匹配<br>
            :’<,’>s/1/2/g 选区替换<br>
            +2s/1/2g 当前行 +2行匹配<br>
            :%s/1/2/gc 每次替换要求确认  
        ")
        main---程序(程序)
        程序---移动(移动)
        移动---代码(代码)
        代码---代码1("
            % 括号匹配跳转<br>
        ")
        移动---代码块(代码块)
        代码块---代码块1("
            [[ 移动到代码块开头<br>
            ][ 移动到代码块末尾<br>
            [{ 无视平级代码块跳到开头<br>
            ]} 跳转到代码块尾部
        ")
        移动---注释(注释内)
        注释---注释1("
            [/ 到注释的开始<br>
            ]/ 到注释的末尾
        ")
        程序---函数(标识符与函数)
        函数---函数1("
            [| 查找标识符
        ")
</div>
